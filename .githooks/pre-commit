#!/bin/sh

# Run the Julia formatter
echo "Running Julia formatter..."
julia --project -e 'using Pkg; Pkg.activate("."); Pkg.instantiate(); using JuliaFormatter; format(".")'

# Run the Julia linter
echo "Running Julia linter..."
julia --project -e 'using Pkg; Pkg.activate("."); Pkg.instantiate(); using Lint; lintdir(".")'

# Run the unit tests
echo "Running unit tests..."
julia --project -e 'using Pkg; Pkg.activate("."); Pkg.instantiate(); Pkg.test()'

# If any of the above commands fail, exit with a non-zero status to prevent the commit
if [ $? -ne 0 ]; then
  echo "Commit aborted due to failed checks."
  exit 1
fi
